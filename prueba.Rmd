---
title: "Grafo de genes ortologos: Datos de prueba de Proteinortho"
output:
  html_document:
    df_print: paged
---

Se utilizo el software *Proteinortho* para obtener las relaciones de ortología entre pares de genes de un set de prueba que simulan pertenecer a distintas especies(C, E, M y L). 
Se obtuvo un archivo (\*.proteinortho-graph) cuyas columnas contienen los pares de genes entre los que se encontro una relación de ortología; 
El evalue y bitscore en ambas direcciones. Se recomienda descargar este repositorio y ejecutar el archivo *prueb..html* para visulaizar la ejecución del codigo en su navegador.

De ese archivo se extrajeron las dos primeras columnas que corresponderia a los pares de genes donde se hallo ortología(En archivo *Prueba_aristas.csv*)

```{r, echo=TRUE, warning=FALSE, cache=FALSE, message=FALSE}

library(igraph)         # Biblioteca para análisis de redes.
library(tidyverse)      # Colección de bibliotecas para manipulación de datos.
library(viridis)        # Biblioteca con paletas de colores.

Aristas <- read.csv("Prueba_aristas.csv") #Carga el documento
Aristas #Muestra el objeto "Aristas"
```
Procedemos a usar la libreria *igraph* para convertir nuestra lista de aristas en una red *G*
```{r}
Aristas %>%
  graph_from_data_frame -> G
G<-as.undirected(G)
  G #Damos un vistazo a la red
```
Podemos ahora comenzar a calcular algunas metricas y visualizar la red
```{r}

V(G) # Nodos de la red.

get.data.frame(G, what="vertices")

E(G) # Aristas de la red.

get.data.frame(G, what="edges") 
```
```{r}
#Vizualización
plot(G,
     vertex.size=10,
     vertex.color="darkorchid",
     vertex.label=NA)    # No queremos ver las etiquetas de los nodos.

V(G)$degree <- degree(G)
get.data.frame(G,what="vertices")

# Ajustamos el tamaño de los nodos.
plot(G,
     vertex.size=2*sqrt(V(G)$degree),
     vertex.color="darkorchid",
     vertex.label=NA)

# Vemos cuáles son los nodos de mayor grado.

degree(G) %>% sort(decreasing=TRUE)

get.data.frame(G,what="vertices") %>%
  as_tibble() %>%
  arrange(-degree) %>%
  head(n=30) %>%
  pull(name)
#Histograma
hist(degree(G)) 
```
```{r}
is_connected(G) #¿Es G, un grafo conexo?
components(G) #¿A qué componente pertenece cada nodo en G?; ¿Cuál es el tamaño de los componentes;¿Cua´l es el número de componentes?
component_distribution(G) #Distribución de componentes en G
hist(component_distribution(G))
decompose(G, max.comps = NA, min.vertices = 0) #Crea un grafo separado para cada componente en G
```

![](componentes_prueba.png)

Comprobamos que las componentes extraídas son consistentes con la salida de proteinortho, usando como ejemplo 3 de sus filas(imagen arriba). La primera fila es consistente con la componente 11, la segunda fila es consistente con la componente 10 y la tercela fila con la componente 9.
